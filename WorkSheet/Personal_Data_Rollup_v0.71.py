#-*- coding:utf-8 -*-
###개인별 정상근무/한외근무 분류해서 받아옴###
import openpyxl
from openpyxl.styles import Alignment, Font, Border, Side, PatternFill
from os import listdir
filepath=listdir('.') #현재 디렉토리를 리스트화
my_font=Font(bold=True,color="FFFFFF") #폰트 설정(볼드,흰색)
fill_GC=PatternFill("solid",fgColor="EF7A54") #GC색 옅게 셀 채우기
thin_border=Border(left=Side(border_style="thin", color="000000"),right=Side(border_style="thin", color="000000"),top=Side(border_style="thin", color="000000"),bottom=Side(border_style="thin", color="000000"))#검은색 thin테두리 설정
under_line=Border(bottom=Side(border_style="thin", color="000000")) #밑에만 테두리
def AssignName(filename):
    name=""
    for ltr in filename[::-1][6:]:
        if ltr.isalpha() is not True:
            break
        else:
            name+=ltr
    return name[::-1]
OCPjobdict={
'강덕원': '팀장', '성기현': '위험/실사관리', '신동현': '위험/실사관리', '우진선': '위험/실사관리', '연대훈': '위험/실사관리', '임하윤': '위험/실사관리', '권영아': '팀장', '서유림': 'QM 운영', '한규동': 'QM 운영', '최원찬': '팀장', '김누리': 'QC운영, QC운영관리', '김영미': 'QC운영', '김영빈': '시험관리', '김재영': 'QC운영', '김주영': 'QC운영', '김지혜': 'QC운영', '남성식': 'QC운영', '박승민': 'QC운영관리', '서성재': '시험, QC운영', '송경문': 'QC운영, QC운영관리', '송기원': '시험, QC운영', '오선영': 'QC운영', '용종만': 'QC운영관리', '원성연': '시험, QC운영', '임정현': 'LIMS운영', '장민지': 'QC운영', '조민주': '시험, QC운영', '최형규': 'QC운영, QC운영관리', '하병헌': '시험, QC운영', '한인호': '시험, QC운영', '허웅': 'QC운영관리', '권지영': '시험', '선종흠': '시험', '이민영': '시험', '이범찬': '시험', '이아라': '시험', '장지혜': '시험관리', '정경원': '시험', '정진홍': '시험', '최윤선': '시험관리', '함재호': '시험', '곽민성': '시험실관리', '김수혁': '시험관리', '김정곤': '시험', '김준용': '시험', '박상협': '시험', '박진희': '시험', '안시후': '시험', '이예람': '시험', '이은지': '시험관리', '이현석': '파견', '정다인': '시험', '홍성주': '시험', '강완용': '시험', '고희승': '시험', '김소희': '시험', '김은지': '시험, 시험관리', '김지철': '시험', '김지한': '시험, 시험관리', '김진영': '시험, 시험관리, 시험실관리', '김한기': '시험', '김희동': '시험', '류민영': '시험, 시험관리', '박웅기': '시험', '박윤상': '시험, 시험관리', '방소희': '시험, 시험관리', '배준모': '시험관리', '신동우': '시험, 시험관리', '연규민': '시험', '오승현': '육아휴직', '우성민': '시험', '유희성': '시험, 시험관리', '윤영욱': '시험', '윤채정': '시험', '이진국': '시험', '이진희': '시험', '장푸름': '시험, 시험관리', '조승연': '시험', '조현경': '시험, 시험관리', '최가연': '시험', '편혜림': '시험', '한선희': '육아휴직', '홍성만': '시험', '김광식': '시험, 시험관리', '김나영': '시험, 시험관리', '김동완': '시험, 시험관리', '김왕규': '시험, 시험관리', '김은선': '시험, 시험관리, 시험실관리', '김진엽': '파견', '나혜정': '시험, 시험관리', '노미정': '시험, 시험관리', '박상범': '시험, 시험관리, 시험실관리', '박지영': '시험, 시험관리', '방봉준': '시험, 시험관리, 시험실관리', '신예지': '시험, 시험관리, 시험실관리', '위수경': '시험, 시험관리', '유기혁': '시험, 시험관리', '윤정화': '시험, 시험관리', '이성진': '시험, 시험관리, 시험실관리', '이수동': '시험, 시험관리', '이혜영': '시험, 시험관리', '정태현': '시험, 시험관리', '최지은': '시험, 시험관리', '한도단': '시험, 시험관리', '한종필': '시험, 시험관리', '한지현': '시험, 시험관리', '홍명환': '시험, 시험관리', '김진규': '시험, 시험관리', '김치현': '시험', '오일영': '시험', '유경식': '시험', '이선희': '시험', '장석원': '시험', '정동주': '시험', '지원태': '시험', '최은아': '시험관리, 시험실 관리', '박동일': '팀장, 품질부서책임자', '김종경': '파트장, 품질부서책임자', '김나연': '글로불린제제 제품담당(~검병), 안정성', '박원호': '알부민제제 제품담당(~검병), CAPA', '이제관': '응고제제 제품담당(~검병), 일탈, 부적합', '이선주': 'S/P 관리, DS제조기록서 발행', '황종미': 'S/P 관리', '이지영': '뉴라펙 제품담당(~검병), 제품품질평가', '박현아': '헌터라제 제품담당(~검병)', '김재희': '알부민제제 제품담당(~검병)', '서영란': '그린진에프 제품담당(~검병)', '이세준': '응고제제 제품담당(~검병)', '이현호': '글로불린제제 제품담당(~검병)', '이유경': '글로불린제제 제품담당(~검병)', '임재혁': '알부민제제 제품담당(~검병)', '김남식': '유전자제제 제품담당(~검병)', '송수연': '응고제제 제품담당(~검병), 부서 교육', '김민주': '글로불린제제 제품담당(~검병)', '이근희': '알부민제제 제품담당(~검병), LIMS', '김현': '파트장', '김웅희': '불만, 불량, 회수, 충전공통 QMS', '박희우': '품질부서책임자', '강기적': '문서, 업무 점검 및 관리(포장,검병)', '이동경': '수입완제,의료기기, 출하,포장 QMS', '신재훈': '일반제제 제품담당(~검병), 출하(수출,임상)', '이나라': '불만, 불량, 출하(내수), 수입완제,의료기기', '정다운': '수출업무', '허성호': '일반제제 제품담당(~검병), CMO관리', '박세윤': '출하, W&FF 관리', '서재황': '품질부서책임자(교육중)', '이성구': '문서, 업무 점검 및 관리(충전)', '박선이': '파트장', '박선하': '해외허가', '김선진': '해외허가', '김상욱': 'QC 변경관리', '조윤식': '일탈, OOS (QC1, SCM(기기분석))', '유화정': '일탈, OOS (QC2, system, 동물))', '윤석빈': '일탈, OOS (SCM(이화학), LIMS)', '이경명': '팀장', '김상훈': 'H/W, S/W 보증', '강석현': 'H/W, S/W 보증', '손혁': 'H/W, S/W 보증', '지윤석': 'H/W, S/W 보증', '이지원': 'H/W, S/W 보증', '김낙우': 'H/W, S/W 보증', '이세연': 'BT파견', '이현정': '퇴직', '김수민': 'H/W, S/W 보증', '김다연': 'H/W, S/W 보증', '차승욱': 'H/W, S/W 보증', '김하연': 'H/W, S/W 보증', '김효진': 'H/W, S/W 보증', '강창헌': '밸리데이션보증', '변상경': '퇴직 예정', '최지민': '밸리데이션보증', '한아름': '밸리데이션보증', '민혜정': '밸리데이션보증', '김준호': '밸리데이션보증', '조소현': '밸리데이션보증', '박천보': '팀장', '박성진': '문서관리자', '김아람': 'GMP교육관리자', '김락영': 'GMP교육관리자,문서관리자,GMP-EDMS, QMS운영담당자', '김민기': '문서관리자', '홍근형': 'GMP-EDMS, QMS운영담당자', '김송이': '문서관리자', '이광호': '문서관리자', '양재연': '문서관리자', '김상미': 'GMP교육관리자,문서관리자,GMP-EDMS, QMS운영담당자', '홍승현': '원자재 보증, 물류보증 관리자', '권민재': '물류보증관리 담당자', '신지현': '원자재 보증 관리자', '안창규': '원자재 보증 관리자', '이미지': '원자재 보증 관리자', '김혜연': '물류품질관리 책임자', '우대균': '원자재 보증 관리자', '이태훈': '물류보증관리 담당자', '정진석': '원자재 보증 담당자', '이우미': '원자재 보증 관리자', '유서영': '원자재 보증 관리자', '최윤호': '혈장 공급업체, 적십자 구입품 관리자', '이정훈': '원료혈장 관리자', '이하늘': '원료혈장 관리 담당자', '최정민': '원료혈장 관리 담당자'
}
OCPpartdict={
'강덕원': 'GQM', '성기현': 'GQM', '신동현': 'GQM', '우진선': 'GQM', '연대훈': 'GQM', '임하윤': 'GQM', '권영아': 'QM지원', '서유림': 'QM지원', '한규동': 'QM지원', '최원찬': '시스템 QC', '김누리': '시스템 QC', '김영미': '시스템 QC', '김영빈': '시스템 QC', '김재영': '시스템 QC', '김주영': '시스템 QC', '김지혜': '시스템 QC', '남성식': '시스템 QC', '박승민': '시스템 QC', '서성재': '시스템 QC', '송경문': '시스템 QC', '송기원': '시스템 QC', '오선영': '시스템 QC', '용종만': '시스템 QC', '원성연': '시스템 QC', '임정현': '시스템 QC', '장민지': '시스템 QC', '조민주': '시스템 QC', '최형규': '시스템 QC', '하병헌': '시스템 QC', '한인호': '시스템 QC', '허웅': '시스템 QC', '권지영': 'SCM QC', '선종흠': 'SCM QC', '이민영': 'SCM QC', '이범찬': 'SCM QC', '이아라': 'SCM QC', '장지혜': 'SCM QC', '정경원': 'SCM QC', '정진홍': 'SCM QC', '최윤선': 'SCM QC', '함재호': 'SCM QC', '곽민성': 'SCM QC', '김수혁': 'SCM QC', '김정곤': 'SCM QC', '김준용': 'SCM QC', '박상협': 'SCM QC', '박진희': 'SCM QC', '안시후': 'SCM QC', '이예람': 'SCM QC', '이은지': 'SCM QC', '이현석': 'SCM QC', '정다인': 'SCM QC', '홍성주': 'SCM QC', '강완용': 'QC1', '고희승': 'QC1', '김소희': 'QC1', '김은지': 'QC1', '김지철': 'QC1', '김지한': 'QC1', '김진영': 'QC1', '김한기': 'QC1', '김희동': 'QC1', '류민영': 'QC1', '박웅기': 'QC1', '박윤상': 'QC1', '방소희': 'QC1', '배준모': 'QC1', '신동우': 'QC1', '연규민': 'QC1', '오승현': 'QC1', '우성민': 'QC1', '유희성': 'QC1', '윤영욱': 'QC1', '윤채정': 'QC1', '이진국': 'QC1', '이진희': 'QC1', '장푸름': 'QC1', '조승연': 'QC1', '조현경': 'QC1', '최가연': 'QC1', '편혜림': 'QC1', '한선희': 'QC1', '홍성만': 'QC1', '김광식': 'QC2', '김나영': 'QC2', '김동완': 'QC2', '김왕규': 'QC2', '김은선': 'QC2', '김진엽': 'QC2', '나혜정': 'QC2', '노미정': 'QC2', '박상범': 'QC2', '박지영': 'QC2', '방봉준': 'QC2', '신예지': 'QC2', '위수경': 'QC2', '유기혁': 'QC2', '윤정화': 'QC2', '이성진': 'QC2', '이수동': 'QC2', '이혜영': 'QC2', '정태현': 'QC2', '최지은': 'QC2', '한도단': 'QC2', '한종필': 'QC2', '한지현': 'QC2', '홍명환': 'QC2', '김진규': '동물 QC', '김치현': '동물 QC', '오일영': '동물 QC', '유경식': '동물 QC', '이선희': '동물 QC', '장석원': '동물 QC', '정동주': '동물 QC', '지원태': '동물 QC', '최은아': '동물 QC', '박동일': 'DS QA', '김종경': 'DS QA', '김나연': 'DS QA', '박원호': 'DS QA', '이제관': 'DS QA', '이선주': 'DS QA', '황종미': 'DS QA', '이지영': 'DS QA', '박현아': 'DS QA', '김재희': 'DS QA', '서영란': 'DS QA', '이세준': 'DS QA', '이현호': 'DS QA', '이유경': 'DS QA', '임재혁': 'DS QA', '김남식': 'DS QA', '송수연': 'DS QA', '김민주': 'DS QA', '이근희': 'DS QA', '김현': 'DP QA', '김웅희': 'DP QA', '박희우': 'DP QA', '강기적': 'DP QA', '이동경': 'DP QA', '신재훈': 'DP QA', '이나라': 'DP QA', '정다운': 'DP QA', '허성호': 'DP QA', '박세윤': 'DP QA', '서재황': 'DP QA', '이성구': 'DP QA', '박선이': 'Site RA', '박선하': 'Site RA', '김선진': 'Site RA', '김상욱': 'Lab QA', ' 조윤식': 'Lab QA', '유화정': 'Lab QA', '윤석빈': 'Lab QA', '이경명': 'HW QE', '김상훈': 'HW QE', '강석현': 'HW QE', '손혁': 'HW QE', '지윤석': 'HW QE', '이지원': 'HW QE', '김낙우': 'SW QE', '이세연': 'SW QE', '이현정': 'SW QE', '김수민': 'SW QE', '김다연': 'SW QE', '차승욱': 'SW QE', '김하연': 'SW QE', '김효진': 'SW QE', '강창헌': 'PV QE', '변상경': 'PV QE', '최지민': 'PV QE', '한아름': 'PV QE', '민혜정': 'PV QE', '김준호': 'PV QE', '조소현': 'HW QE', '박천보': '시스템 QA', '박성진': '시스템 QA', '김아람': '시스템 QA', '김락영': '시스템 QA', '김민기': '시스템 QA', '홍근형': '시스템 QA', '김송이': '시스템 QA', '이광호': '시스템 QA', '양재연': '시스템 QA', '김상미': '시스템 QA', '홍승현': 'SCM QA', '권민재': 'SCM QA', '신지현': 'SCM QA', '안창규': 'SCM QA', '이미지': 'SCM QA', '김혜연': 'SCM QA', '우대균': 'SCM QA', '이태훈': 'SCM QA', '정진석': 'SCM QA', '이우미': 'SCM QA', '유서영': 'SCM QA', '최윤호': 'Plasma QA', '이정훈': 'Plasma QA', '이하늘': 'Plasma QA', '최정민': 'Plasma QA'
}
ESPjobdict={
'김태훈': '팀장', '김준희': '품질부서책임자', '윤형진': '제품품질 및 원자재 보증담당자', '서동석': '제품품질 및 원자재 보증담당자', '원진석': '제품품질 및 원자재 보증담당자', '박리윤': '제품품질 및 원자재 보증담당자', '김승우': '제품품질 및 원자재 보증담당자', '정미래': '제품품질 및 원자재 보증담당자', '변재연': '제품품질 및 원자재 보증담당자', '구자준': 'H/W, S/W 보증관리 및 밸리데이션보증 담당자', '오웅조': 'H/W, S/W 보증관리 및 밸리데이션보증 담당자', '권보민': 'H/W, S/W 보증관리 및 밸리데이션보증 담당자', '권봉성': 'H/W, S/W 보증관리 및 밸리데이션보증 담당자', '박요한': 'H/W, S/W 보증관리 및 밸리데이션보증 담당자', '노도형': '제품품질 및 원자재 보증담당자', '손자연': '제품품질 및 원자재 보증담당자', '김범창': '팀장', '김둘이': 'QC운영관리 및 시험실관리자', '박소희': 'QC운영담당 및 시험자', '김종숙': '시험자', '정주희': '시험자', '정영석': '시험자', '고의건': '시험자', '홍기연': '시험자', '김성태': '시험자', '윤다예': '시험자', '강민지': '시험자', '박현순': '시험자', '양승호': '시험자', '이창훈': '시험자', '박성미': '시험자', '정재헌': 'QC운영관리 및 시험관리자', '지은영': '시험자', '김세환': '시험자', '고시은': '시험자', '이강수': '시험자', '정다혜': '시험자', '홍철기': '시험자', '김하빈': '시험자', '김승회': 'QC운영관리 및 시험관리자', '류황민': '시험자'}
ESPpartdict={
'김태훈': 'QA', '김준희': 'QA', '윤형진': 'QA', '서동석': 'QA', '원진석': 'QA', '박리윤': 'QA', '김승우': 'QA', '정미래': 'QA', '변재연': 'QA', '구자준': 'QE', '오웅조': 'QE', '권보민': 'QE', '권봉성': 'QE', '박요한': 'QE', '노도형': 'QA', '손자연': 'QA', '김범창': '시스템 QC', '김둘이': '시스템 QC', '박소희': '시스템 QC', '김종숙': '시스템 QC', '정주희': '시스템 QC', '정영석': '시스템 QC', '고의건': 'QC1', '홍기연': 'QC1', '김성태': 'QC1', '윤다예': 'QC1', '강민지': 'QC1', '박현순': 'QC1', '양승호': 'QC1', '이창훈': 'QC1', '박성미': 'QC1', '정재헌': 'QC2', '지은영': 'QC2', '김세환': 'QC2', '고시은': 'QC2', '이강수': 'QC2', '정다혜': 'QC2', '홍철기': 'QC2', '김하빈': 'QC2', '김승회': 'QC1', '류황민': '신제품 QC'
}
HSPjobdict={
'이인규': '팀장', '성희진': '시험실 보증관리', '최재유': 'GMP교육관리자', '이은비': '실사관리자', '강성국': '품질부서책임자', '김초원': '실사관리자', '채규탁': '문서관리자', '김민섭': '제품품질 및 원자재보증관리자', '신명래': '제품품질 및 원자재보증관리자', '정수현': '문서관리자', '채수연': '제품품질 및 원자재보증관리자', '김치화': '품질부서책임자', '박민정': '제품품질보증담당', '주정현': '제품품질보증담당', '박지민': '제품품질보증담당', '최준호': '제품품질보증담당', '김정일': 'H/W, S/W 보증관리자 및 밸리데이션보증', '김환식': 'H/W, S/W 보증', '염규민': 'H/W, S/W 보증 및 밸리데이션보증담당자', '이은교': '밸리데이션보증담당자', '강지빈': 'H/W, S/W 보증', '성원엽': 'H/W, S/W 보증 및 밸리데이션보증담당자', '한원지': 'H/W, S/W 보증 및 밸리데이션보증담당자', '박종찬': '밸리데이션보증담당자', '김지수': 'H/W, S/W 보증 및 밸리데이션보증담당자', '한개은': '제품품질보증담당', '방진영': '제품품질보증담당', '송유주': '제품품질보증담당', '홍성구': '팀장', '문영인': 'GC BT 파견', '김동옥': 'QC운영관리자', '박지영': 'QC운영담당자', '배상철': '검체 접수 및 관리', '황규정': '검체 접수 및 관리', '강진규': 'QC운영관리자 및 시험실관리자', '조윤현': 'QC운영담당자 및 시험자', '양훈식': '시험자', '이수': '시험자', '최장수': '시험자', '김산하': 'QC운영담당자 및 시험자', '송승형': '시험자', '안초롱': 'QC운영담당자 및 시험자', '신나라': '시험자', '우승빈': '시험자', '정승기': '시험자', '최재욱': '시험자', '황유철': '시험자', '유지연': '시험자', '박순원': 'QC운영담당자 및 시험자', '박병욱': 'QC운영담당자 및 시험자', '장민혁': '시험자', '박재섭': 'QC운영관리자 및 시험실관리자', '김민정': 'QC운영담당자 및 시험자', '김인권': '시험자', '박소희': 'QC운영담당자 및 시험자', '김민': '시험자', '정인규': '시험자', '성유림': 'QC운영담당자 및 시험자', '손보아': '시험자', '이미지': '시험자', '이용진': '시험자', '정선혜': 'QC운영담당자 및 시험자', '한지은': '시험자', '강동우': 'QC운영담당자 및 시험자', '손동혁': 'QC운영담당자 및 시험자', '윤한솔': '시험자', '이경훈': 'QC운영담당자 및 시험자', '손정진': 'QC운영담당자 및 시험자', '정우성': 'QC운영담당자 및 시험자', '김두희': 'QC운영담당자', '김정은': 'QC운영담당자 및 시험자', '이중진': '검체 접수 및 관리', '윤채희': 'QC운영담당자', '이도엽': 'QC운영담당자 및 시험자', '홍재우': '시험자', '박다현': 'QC운영담당자 및 시험자'}
HSPpartdict={
'이인규': '시스템 QA', '성희진': '시스템 QA', '최재유': '시스템 QA', '이은비': '시스템 QA', '강성국': 'QA1', '김초원': 'QA1', '채규탁': 'QA1', '김민섭': 'QA1', '신명래': 'QA1', '정수현': 'QA1', '채수연': 'QA1', '김치화': 'QA2', '박민정': 'QA2', '주정현': 'QA2', '박지민': 'QA2', '최준호': 'QA2', '김정일': 'QE', '김환식': 'QE', '염규민': 'QE', '이은교': 'QE', '강지빈': 'QE', '성원엽': 'QE', '한원지': 'QE', '박종찬': 'QE', '김지수': 'QE', '한개은': '신제품 QA', '방진영': '신제품 QA', '송유주': 'QA2', '홍성구': '시스템 QC', '문영인': '시스템 QC', '김동옥': '시스템 QC', '박지영': '시스템 QC', '배상철': '시스템 QC', '황규정': '시스템 QC', '강진규': 'QC1', '조윤현': 'QC1', '양훈식': 'QC1', '이수': 'QC1', '최장수': 'QC1', '김산하': 'QC1', '송승형': 'QC1', '안초롱': 'QC1', '신나라': 'QC1', '우승빈': 'QC1', '정승기': 'QC1', '최재욱': 'QC1', '황유철': 'QC1', '유지연': 'QC1', '박순원': 'QC1', '박병욱': 'QC1', '장민혁': 'QC1', '박재섭': 'QC2', '김민정': 'QC2', '김인권': 'QC2', '박소희': 'QC2', '김민': 'QC2', '정인규': 'QC2', '성유림': 'QC2', '손보아': 'QC2', '이미지': 'QC2', '이용진': 'QC2', '정선혜': 'QC2', '한지은': 'QC2', '강동우': 'QC2', '손동혁': 'QC2', '윤한솔': 'QC2', '이경훈': 'QC2', '손정진': 'QC1', '정우성': 'QC2', '김두희': '시스템 QC', '김정은': 'QC2', '이중진': '시스템 QC', '윤채희': '시스템 QC', '이도엽': 'QC1', '홍재우': 'QC2', '박다현': 'QC1'}
OCPlevel={
'강덕원': 'GL5', '성기현': 'GL3', '신동현': 'GL3', '우진선': 'GL2', '임하윤': 'GL1', '연대훈': 'GL1', '권영아': 'GL5', '서유림': 'GL2', '한규동': 'GL1', '최원찬': 'GL5', '김누리': 'GL1', '김영미': 'GL2', '김영빈': 'GL3', '김재영': '촉탁', '김주영': 'GL2', '김지혜': 'GL1', '남성식': 'GL1', '박승민': 'GL2', '서성재': 'GL1', '송기원': 'GL1', '오선영': 'GL1', '용종만': 'GL4', '원성연': 'GL1', '임정현': 'GL2', '장민지': 'GL1', '조민주': 'GL1', '최형규': 'GL1', '하병헌': 'GL1', '한인호': 'GL1', '허웅': 'GL3', '강완용': 'GL2', '고희승': 'GL1', '김소희': 'GL1', '김은지': 'GL1', '김지철': 'GL2', '김지한': 'GL3', '김진영': 'GL5', '김한기': 'GL1', '김희동': 'GL1', '류민영': 'GL2', '박웅기': 'GL1', '박윤상': 'GL1', '방소희': 'GL3', '배준모': 'GL3', '신동우': 'GL1', '연규민': 'GL1', '우성민': 'GL1', '유희성': 'GL1', '윤영욱': 'GL1', '윤채정': 'GL1', '이진국': 'GL2', '이진희': 'GL1', '장푸름': 'GL2', '조승연': '촉탁', '조현경': 'GL2', '최가연': 'GL1', '편혜림': 'GL2', '홍성만': 'GL1', '김광식': 'GL1', '김나영': 'GL1', '김동완': 'GL1', '김왕규': 'GL2', '김은선': 'GL2', '나혜정': 'GL1', '노미정': 'GL1', '박상범': 'GL3', '박지영': 'GL1', '방봉준': 'GL2', '신예지': 'GL2', '위수경': 'GL1', '유기혁': 'GL1', '윤정화': 'GL2', '이성진': 'GL4', '이수동': 'GL1', '이혜영': 'GL3', '정태현': 'GL1', '최지은': 'GL1', '한도단': 'GL1', '한종필': 'GL2', '한지현': 'GL2', '홍명환': 'GL2', '최은아': 'GL5', '김진규': 'GL3', '오일영': 'GL2', '유경식': 'GL2', '장석원': 'GL3', '김치현': 'GL1', '정동주': 'GL1', '지원태': 'GL2', '이선희': 'GL1', '권지영': 'GL2', '선종흠': 'GL3', '이민영': 'GL1', '이범찬': 'GL1', '이아라': 'GL1', '장지혜': 'GL2', '정경원': 'GL2', '정진홍': 'GL1', '최윤선': 'GL3', '함재호': 'GL1', '곽민성': 'GL3', '김수혁': 'GL3', '김정곤': 'GL2', '김준용': 'GL1', '박상협': 'GL1', '박진희': 'GL1', '안시후': 'GL1', '이예람': 'GL1', '이은지': 'GL3', '정다인': 'GL1', '홍성주': 'GL2', '박천보': 'GL5', '박성진': 'GL3', '김아람': 'GL3', '김락영': 'GL3', '김민기': 'GL3', '홍근형': 'GL3', '김송이': 'GL1', '이광호': 'GL1', '양재연': 'GL1', '김상미': '촉탁', '홍승현': 'GL4', '권민재': 'GL4', '신지현': 'GL4', '안창규': 'GL3', '이미지': 'GL3', '김혜연': 'GL3', '우대균': 'GL2', '이태훈': 'GL1', '정진석': 'GL1', '이우미': 'GL1', '유서영': 'GL1', '최윤호': 'GL2', '이정훈': 'GL2', '이하늘': 'GL1', '최정민': 'GL1', '박동일': 'GL5', '김종경': 'GL4', '김나연': 'GL3', '박원호': 'GL3', '이제관': 'GL3', '이선주': 'GL2', '황종미': 'GL3', '이지영': 'GL2', '박현아': 'GL2', '김재희': 'GL1', '서영란': 'GL2', '이세준': 'GL1', '이현호': 'GL1', '이유경': 'GL2', '임재혁': 'GL1', '김남식': 'GL1', '송수연': 'GL1', '김민주': 'GL1', '이근희': 'GL1', '김현': 'GL4', '김웅희': 'GL3', '박희우': 'GL3', '강기적': 'GL3', '이동경': 'GL2', '신재훈': 'GL1', '이나라': 'GL1', '정다운': 'GL1', '허성호': 'GL1', '박세윤': 'GL1', '서재황': 'GL1', '이성구': '촉탁', '박선이': 'GL4', '김선진': '촉탁', '김상욱': 'GL5', '조윤식': 'GL2', '유화정': 'GL1', '윤석빈': 'GL1', '이경명': 'GL5', '김상훈': 'GL3', '강석현': 'GL3', '손혁': 'GL3', '지윤석': 'GL2', '이지원': 'GL2', '김낙우': 'GL3', '김수민': 'GL1', '김다연': 'GL1', '차승욱': 'GL1', '김하연': 'GL1', '김효진': 'GL1', '강창헌': 'GL3', '최지민': 'GL2', '한아름': 'GL1', '민혜정': 'GL1', '김준호': 'GL1', '조소현': 'GL1'}
ESPlevel={
'김범창': 'GL4', '김둘이': 'GL3', '박소희': 'GL2', '김종숙': 'GL2', '정주희': 'GL2', '정영석': 'GL1', '고의건': 'GL2', '홍기연': 'GL2', '김성태': 'GL2', '윤다예': 'GL2', '강민지': 'GL2', '박현순': 'GL1', '양승호': 'GL1', '이창훈': 'GL1', '박성미': 'GL1', '정재헌': 'GL3', '지은영': 'GL2', '김세환': 'GL2', '고시은': 'GL1', '이강수': 'GL1', '정다혜': 'GL1', '홍철기': 'GL1', '김하빈': 'GL1', '김승회': 'GL3', '류황민': 'GL1', '김태훈': 'GL4', '김준희': 'GL4', '윤형진': 'GL3', '서동석': 'GL3', '원진석': 'GL3', '김승우': 'GL1', '정미래': 'GL1', '변재연': '촉탁', '노도형': 'GL2', '손자연': 'GL2', '구자준': 'GL3', '오웅조': 'GL3', '권보민': 'GL2', '권봉성': 'GL2', '박요한': 'GL1'}
HSPlevel={
'홍성구': 'GL5', '김동옥': 'GL3', '박지영': 'GL2', '배상철': 'GL2', '황규정': '촉탁', '강진규': 'GL3', '조윤현': 'GL3', '양훈식': 'GL2', '이수': 'GL2', '최장수': 'GL2', '김산하': 'GL2', '송승형': 'GL2', '안초롱': 'GL2', '신나라': 'GL1', '우승빈': 'GL1', '정승기': 'GL1', '최재욱': 'GL1', '황유철': 'GL1', '유지연': 'GL1', '박순원': 'GL1', '박병욱': 'GL1', '장민혁': '촉탁', '박재섭': 'GL3', '김민정': 'GL3', '김인권': 'GL2', '박소희': 'GL3', '김민': 'GL2', '정인규': 'GL2', '성유림': 'GL2', '손보아': 'GL1', '이미지': 'GL1', '이용진': 'GL1', '정선혜': 'GL1', '한지은': 'GL1', '강동우': 'GL1', '손동혁': 'GL1', '윤한솔': 'GL1', '이경훈': 'GL3', '손정진': 'GL2', '정우성': 'GL3', '김두희': 'GL2', '김정은': 'GL2', '이중진': 'GL1', '윤채희': 'GL1', '이도엽': 'GL1', '홍재우': 'GL1', '박다현': 'GL1', '이인규': 'GL4', '성희진': 'GL3', '최재유': 'GL3', '이은비': 'GL1', '강성국': 'GL4', '김초원': 'GL2', '채규탁': 'GL2', '김민섭': 'GL2', '신명래': 'GL1', '정수현': 'GL1', '채수연': 'GL1', '김치화': 'GL4', '박민정': 'GL3', '주정현': 'GL3', '박지민': 'GL2', '최준호': 'GL1', '김정일': 'GL4', '김환식': 'GL3', '염규민': 'GL2', '이은교': 'GL3', '강지빈': 'GL1', '성원엽': 'GL2', '한원지': 'GL1', '박종찬': 'GL1', '김지수': 'GL1', '한개은': 'GL3', '방진영': 'GL1', '송유주': 'GL1'}
for files in filepath:
    if ".xlsm" in str(files):
        wb=openpyxl.load_workbook(files, data_only=True)
        print("현재 읽고있는 중인 파일:",files)
        lst=["0309","0310","0311","0312","0313","0316","0317","0318","0319","0320","0323","0324","0325","0326","0327","0330","0331","0401","0402","0403","0406","0407","0408","0409","0410"]
        wb.create_sheet("Total")
        rslt=wb["Total"] #wb.get_sheet_by_name("Total")
        rslt["A1"],rslt["C1"],rslt["E1"],rslt["G1"]="파트","직무(업무)","이름","GLevel"
        rslt["A2"],rslt["B2"],rslt["C2"],rslt["D2"]="날짜","작업분류","프로세스(L3)","태스크(L4)"
        rslt["E2"],rslt["F2"],rslt["G2"]="SOP No. / Product code","세부 내용","시험/검토/승인(수)"
        rslt["H2"],rslt["I2"],rslt["J2"]="이론시간(분)","실제시간(분)","한외근무(분)"
        j=3
        for shday in lst:
            try:
                dws=wb[shday]
            except:
                continue
            i,sn=8,0
            while dws.cell(row=6,column=sn+12).value!=40: #08:40분 출발에서 17:30까지
                sn+=1
            sn=sn+12 #sn,en 이렇게 한줄에 쓰면 en이 원하는 숫자만큼 안 간다.
            en=sn+53
            while dws["D"+str(i)].value!=None and str(dws["D"+str(i)].value)!="0": #프로세스 값이 None도 아니면서 0도 아닐 동안.(프로세스가 None이거나 0이면 루프를 돌지 않음.)
                WT,EWT=0,0 #WT:정상근무시간, EWT:초과근무시간
                #RGB상으론 FFFFFF가 흰색인데, 인덱스 상으론 흰색은 0이고, 검은색은 1이고,(00)000000은 색 없음임.
                for coln in range(sn,en+1): #sn에서 en까지(54개)
                    if str(dws.cell(row=i,column=coln).fill.start_color.index)[2:]!="000000" and str(dws.cell(row=i,column=coln).fill.start_color.index)!="0":
                        WT+=1
                for coln2 in range(en+1,en+91): #en+1에서 en+90까지(90개)
                    if str(dws.cell(row=i,column=coln2).fill.start_color.index)[2:]!="000000" and str(dws.cell(row=i,column=coln2).fill.start_color.index)!="0":
                        EWT+=1
                rslt["A"+str(j)]=str(shday)[:2]+"/"+str(shday[2:]) #A열에 날짜 입력
                rslt["B"+str(j)],rslt["C"+str(j)],rslt["D"+str(j)]=dws["B"+str(i)].value,str(dws["C"+str(i)].value)+" / "+str(dws["D"+str(i)].value),str(dws["E"+str(i)].value)+" / "+str(dws["F"+str(i)].value)
                rslt["E"+str(j)],rslt["F"+str(j)],rslt["G"+str(j)]=dws["G"+str(i)].value,dws["H"+str(i)].value,dws["I"+str(i)].value
                rslt["H"+str(j)],rslt["I"+str(j)],rslt["J"+str(j)]=dws["J"+str(i)].value,WT*10,EWT*10
                i+=1
                j+=1
                if rslt["A"+str(j-2)].value!=rslt["A"+str(j-1)].value:
                    for row in rslt["A"+str(j-2):"J"+str(j-2)]:
                        for cell in row:
                            cell.border=under_line
        rslt.column_dimensions["A"].width,rslt.column_dimensions["B"].width,rslt.column_dimensions["C"].width=7,11,15
        rslt.column_dimensions["D"].width,rslt.column_dimensions["E"].width,rslt.column_dimensions["F"].width=15,24,21
        rslt.column_dimensions["G"].width,rslt.column_dimensions["H"].width,rslt.column_dimensions["I"].width,rslt.column_dimensions["J"].width=19,13,13,15
        for k in range(10): #통합 변경(셀 폰트, 셀 채우기, 셀 테두리)
            rslt.cell(row=2,column=k+1).font=my_font
            rslt.cell(row=2,column=k+1).fill=fill_GC
            rslt.cell(row=2,column=k+1).border=thin_border
        rslt["A1"].font,rslt["C1"].font,rslt["E1"].font,rslt["G1"].font=my_font,my_font,my_font,my_font #특정 셀 폰트 변경
        rslt["A1"].fill,rslt["C1"].fill,rslt["E1"].fill,rslt["G1"].fill=fill_GC,fill_GC,fill_GC,fill_GC #특정 셀 색 채우기
        rslt["A1"].border,rslt["C1"].border,rslt["E1"].border,rslt["G1"].border=thin_border,thin_border,thin_border,thin_border #(특정 셀) 테두리 그리기
        rslt.auto_filter.ref = "A2:J2" #해당범위 자동 필터(#"A2:J"+str(j-1)처럼 전체 대상 범위를 잡아줘도 된다.)
        elst=wb.sheetnames #wb.get_sheet_names() -> 시트이름을 리스트로 받음 #print(elst)
        for names in elst: #시트 삭제(lst안에 없는 시트명을 가진 시트를 삭제)
            if names not in lst and names!="Total":
                del wb[names]
        rslt["F1"]=AssignName(files)
        if "OCP" in str(files) or "QA(compliance)" in str(files) or "QM지원" in str(files) or "GQM" in str(files):
            rslt["B1"],rslt["D1"],rslt["H1"]=OCPpartdict.get(rslt["F1"].value),OCPjobdict.get(rslt["F1"].value),OCPlevel.get(rslt["F1"].value)
        elif "ESP" in str(files):
            rslt["B1"],rslt["D1"],rslt["H1"]=ESPpartdict.get(rslt["F1"].value),ESPjobdict.get(rslt["F1"].value),ESPlevel.get(rslt["F1"].value)
        elif "HSP" in str(files):
            rslt["B1"],rslt["D1"],rslt["H1"]=HSPpartdict.get(rslt["F1"].value),HSPjobdict.get(rslt["F1"].value),HSPlevel.get(rslt["F1"].value)
        wb.save(files[files.index("("):-5]+"_result.xlsx")
